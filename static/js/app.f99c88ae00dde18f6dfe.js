webpackJsonp([7],{"6bJc":function(e,t,r){"use strict";var n=r("Xxa5"),a=r.n(n),c=r("exGp"),s=r.n(c),i=r("JnRc"),o=r.n(i),u=o.a.Object.extend("Categories"),p=o.a.Object.extend("Tag"),d=o.a.Object.extend("Todo"),f=(o.a.Object.extend("TodoTag"),function(e){return e.rawMessage||e.message||e.stack||e}),h=null;function l(){return h}var v,w,m,g,x,b,y,k=(v=s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=o.a.User.current(),e.t0=t,!e.t0){e.next=7;break}return e.next=6,t.isAuthenticated();case 6:e.t0=e.sent;case 7:if(!e.t0){e.next=10;break}return h=t,e.abrupt("return",h);case 10:e.next=15;break;case 12:throw e.prev=12,e.t1=e.catch(0),f(e.t1);case 15:case"end":return e.stop()}},e,this,[[0,12]])})),function(){return v.apply(this,arguments)}),j=(w=s()(a.a.mark(function e(t){var r,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new o.a.Query("User"),n=!1,e.prev=2,e.next=5,r.get(t);case 5:n=e.sent,e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(2),f("无效的邀请码");case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e,this,[[2,8]])})),function(e){return w.apply(this,arguments)}),O=(m=s()(a.a.mark(function e(t){var r,n,c=t.username,s=t.password,i=t.email;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new o.a.User).setUsername(c),r.setPassword(s),r.setEmail(i),r.set("nickname",c),e.prev=5,e.next=8,r.signUp();case 8:return n=e.sent,h=n,e.abrupt("return",n);case 13:throw e.prev=13,e.t0=e.catch(5),f(e.t0);case 16:case"end":return e.stop()}},e,this,[[5,13]])})),function(e){return m.apply(this,arguments)}),T=(g=s()(a.a.mark(function e(t){var r,n=t.username,c=t.password;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.User.logIn(n,c);case 3:return r=e.sent,e.next=6,r.refreshSessionToken();case 6:return h=r,e.abrupt("return",h);case 10:throw e.prev=10,e.t0=e.catch(0),f(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])})),function(e){return g.apply(this,arguments)}),A=(x=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.User.logOut();case 2:h=null;case 3:case"end":return e.stop()}},e,this)})),function(){return x.apply(this,arguments)}),C=(b=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",o.a.User.requestPasswordReset(t));case 4:throw e.prev=4,e.t0=e.catch(0),f(e.t0);case 7:case"end":return e.stop()}},e,this,[[0,4]])})),function(e){return b.apply(this,arguments)}),W=r("fZjL"),D=r.n(W),q=(y=s()(a.a.mark(function e(t){var r,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=new o.a.Query("Todo")).equalTo("owner",l()),r.equalTo("categories",t),r.select(["categories"]),e.next=7,r.find();case 7:if(!(n=e.sent)||!n.length){e.next=12;break}return n.forEach(function(e){e.set("categories",o.a.Object.createWithoutData("Categories","all"))}),e.next=12,o.a.Object.saveAll(n);case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(0),f(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),function(e){return y.apply(this,arguments)}),L=function(){var e=s()(a.a.mark(function e(t,r){var n,c,s,i,p;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:if(!((n=e.sent)&&D()(n).length>=10)){e.next=7;break}throw f("超出上限， 最多只能创建10个分类");case 7:e.t0=a.a.keys(n);case 8:if((e.t1=e.t0()).done){e.next=14;break}if(c=e.t1.value,n[c].name!==t){e.next=12;break}throw f("已经存在同名的分类");case 12:e.next=8;break;case 14:return(s=new u).set("name",t),s.set("order",r||0),s.set("owner",l()),(i=new o.a.ACL).setReadAccess(l(),!0),i.setWriteAccess(l(),!0),s.setACL(i),e.prev=22,e.next=25,s.save();case 25:return p=e.sent,e.abrupt("return",{id:p.id,name:p.get("name"),order:p.get("order")});case 29:throw e.prev=29,e.t2=e.catch(22),f(e.t2);case 32:case"end":return e.stop()}},e,this,[[22,29]])}));return function(t,r){return e.apply(this,arguments)}}(),E=function(){var e=s()(a.a.mark(function e(t,r,n){var c,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=o.a.Object.createWithoutData("Categories",t),r&&c.set("name",r),n&&c.set("order",n||"0"),e.prev=3,e.next=6,c.save();case 6:return s=e.sent,e.abrupt("return",{id:s.id,name:s.get("name"),order:s.get("order")});case 10:throw e.prev=10,e.t0=e.catch(3),f(e.t0);case 13:case"end":return e.stop()}},e,this,[[3,10]])}));return function(t,r,n){return e.apply(this,arguments)}}(),z=function(){var e=s()(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.a.Object.createWithoutData("Categories",t),e.next=3,q(r);case 3:return e.prev=3,e.next=6,r.destroy();case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),f(e.t0);case 11:case"end":return e.stop()}},e,this,[[3,8]])}));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=s()(a.a.mark(function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",name:"",strictName:""},c=n.id,s=n.name,i=n.strictName;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=new o.a.Query("Categories")).exists("owner"),c&&t.equalTo("objectId",c),s&&t.contains("name",s),i&&t.equalTo("name",i),t.equalTo("owner",l()),t.select(["name","order"]),t.ascending("order"),t.limit(999),e.next=12,t.find();case 12:return r=e.sent,e.abrupt("return",[].reduce.call(r,function(e,t,r,n){return e[t.id]={id:t.id,name:t.get("name"),order:t.get("order")},e},{}));case 16:throw e.prev=16,e.t0=e.catch(0),f(e.t0);case 19:case"end":return e.stop()}},e,this,[[0,16]])}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=s()(a.a.mark(function e(t,r){var n,c,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(n=new p).set("name",t),n.set("order",r||0),n.set("owner",l()),(c=new o.a.ACL).setReadAccess(l(),!0),c.setWriteAccess(l(),!0),n.setACL(c),e.next=11,n.save();case 11:return s=e.sent,e.abrupt("return",{id:s.id,name:s.get("name"),order:s.get("order")});case 15:throw e.prev=15,e.t0=e.catch(0),f(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])}));return function(t,r){return e.apply(this,arguments)}}(),U=function(){var e=s()(a.a.mark(function e(t,r,n){var c,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=o.a.Object.createWithoutData("Tag",t),r&&c.set("name",r),n&&c.set("order",n),e.next=6,c.save();case 6:return s=e.sent,e.abrupt("return",{id:s.id,name:s.get("name"),order:s.get("order")});case 10:throw e.prev=10,e.t0=e.catch(0),f(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return function(t,r,n){return e.apply(this,arguments)}}(),I=function(){var e=s()(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=o.a.Object.createWithoutData("Tag",t),e.next=4,r.destroy();case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),f(e.t0);case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=s()(a.a.mark(function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",name:""},c=n.id,s=n.name;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=new o.a.Query("Tag")).exists("owner"),c&&t.equalTo("objectId",c),s&&t.contains("name","name"),t.equalTo("owner",l()),t.select(["name","order"]),t.ascending("order"),t.limit(999),e.next=11,t.find();case 11:return r=e.sent,e.abrupt("return",[].reduce.call(r,function(e,t,r,n){return e[t.id]={id:t.id,name:t.get("name"),order:t.get("order")},e},{}));case 15:throw e.prev=15,e.t0=e.catch(0),f(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])}));return function(){return e.apply(this,arguments)}}(),Q=r("BX4k"),J=r.n(Q),M=r("DyNK"),N=r.n(M),H=function(){var e=s()(a.a.mark(function e(){var t,r,n,c,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:"",content:"",status:0,priority:0,reminder:"none",categories:""},i=s.title,u=s.content,p=s.status,h=s.priority,v=(s.reminder,s.categories);return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=new o.a.ACL).setWriteAccess(l(),!0),t.setReadAccess(l(),!0),(r=new d).setACL(t),r.set("owner",l()),r.set("title",J()(i||"")),r.set("content",J()(u||"")),r.set("status",p||0),r.set("priority",h||0),v?(n=o.a.Object.createWithoutData("Categories",v),r.set("categories",n)):r.set("categories",o.a.Object.createWithoutData("Categories","all")),e.next=14,r.save();case 14:return c=e.sent,e.abrupt("return",{id:c.id,title:N()(c.get("title")),content:N()(c.get("content")),status:c.get("status"),priority:c.get("priority"),categories:c.get("categories")?c.get("categories").id:"all"});case 18:throw e.prev=18,e.t0=e.catch(0),f(e.t0);case 21:case"end":return e.stop()}},e,this,[[0,18]])}));return function(){return e.apply(this,arguments)}}(),K=function(){var e=s()(a.a.mark(function e(t,r){var n,c,s,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=o.a.Object.createWithoutData("Todo",t),r.title&&n.set("title",J()(r.title)),r.content&&n.set("content",J()(r.content)),Object.hasOwnProperty.call(r,"status")&&n.set("status",r.status),Object.hasOwnProperty.call(r,"categories")&&((c=r.categories)?(s=o.a.Object.createWithoutData("Categories",c),n.set("categories",s)):n.set("categories",o.a.Object.createWithoutData("Categories","all"))),e.next=8,n.save();case 8:return i=e.sent,e.abrupt("return",{id:i.id,title:N()(i.get("title")),content:N()(i.get("content")),status:i.get("status"),priority:i.get("priority"),categories:i.get("categories")?i.get("categories").id:"all"});case 12:throw e.prev=12,e.t0=e.catch(0),f(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(t,r){return e.apply(this,arguments)}}(),S=function(){var e=s()(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=o.a.Object.createWithoutData("Todo",t),e.next=4,r.destroy();case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),f(e.t0);case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=s()(a.a.mark(function e(){var t,r,n,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",keyword:"",categories:""},s=c.id,i=c.keyword,u=c.categories;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=new o.a.Query("Todo")).exists("owner"),s&&t.equalTo("objectId",s),i&&(t.contains("title",i),t.contains("content",i)),u&&(r=o.a.Object.createWithoutData("Categories",u),t.equalTo("categories",r)),t.equalTo("owner",l()),t.select(["title","content","status","priority","categories"]),t.ascending("createdAt"),t.limit(999),e.next=12,t.find();case 12:return n=e.sent,e.abrupt("return",[].reduce.call(n,function(e,t,r,n){return e.push({id:t.id,title:N()(t.get("title")),content:N()(t.get("content")),status:t.get("status"),priority:t.get("priority"),categories:t.get("categories")?t.get("categories").id:"all"}),e},[]));case 16:throw e.prev=16,e.t0=e.catch(0),f(e.t0);case 19:case"end":return e.stop()}},e,this,[[0,16]])}));return function(){return e.apply(this,arguments)}}();r.d(t,"j",function(){return G}),r.d(t,"h",function(){return l}),r.d(t,"i",function(){return j}),r.d(t,"k",function(){return T}),r.d(t,"l",function(){return A}),r.d(t,"m",function(){return O}),r.d(t,"g",function(){return C}),r.d(t,"a",function(){return L}),r.d(t,"n",function(){return E}),r.d(t,"c",function(){return z}),r.d(t,"e",function(){return R}),r.d(t,!1,function(){return P}),r.d(t,!1,function(){return U}),r.d(t,!1,function(){return I}),r.d(t,!1,function(){return $}),r.d(t,"b",function(){return H}),r.d(t,"o",function(){return K}),r.d(t,"d",function(){return S}),r.d(t,"f",function(){return _});var G=function(){var e=s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.a.init({appId:"PwJpIXfhKL1WH0QDmdutG9Eb-gzGzoHsz",appKey:"RPeMx26ScrwDY2Iutozf2vR1"}),localStorage.removeItem("debug"),e.next=5,k();case 5:return t=e.sent,e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},"7zck":function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7+uW"),a=r("3EgV"),c=r.n(a),s=r("6bJc"),i=(r("uMhA"),r("7zck"),r("y1vT")),o=r.n(i),u={name:"App",data:function(){return{wrapEL:null}},mounted:function(){var e=this;this.$nextTick(function(){e.wrapEL=e.$refs["router-wrapper"],window.addEventListener("resize",e.onResize,{passive:!0}),window.dispatchEvent(new Event("resize"))})},beforeDestroy:function(){window.removeEventListener("resize",this.onResize,{passive:!0})},computed:{onResize:function(){var e=this;return o()(function(){var t=e.wrapEL.classList;t.value="";var r=e.$vuetify.breakpoint;r.xs?t.add("mini"):t.add("normal"),e.$bus.$emit("foldSideBar",r.width>850)},300)}}},p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"router-wrapper",staticClass:"normal"},[t("router-view")],1)},staticRenderFns:[]};var d=r("VU/8")(u,p,!1,function(e){r("oYr4")},null,null).exports,f=r("/ocq");n.default.use(f.a);var h=new f.a({mode:"history",routes:[{path:"/account",component:function(){return r.e(2).then(r.bind(null,"/mx1"))},meta:{title:"登录"},children:[{path:"",redirect:"signin"},{path:"signin",name:"signin",component:function(){return Promise.all([r.e(0),r.e(4)]).then(r.bind(null,"8vqq"))},meta:{title:"登录"}},{path:"signup",name:"signup",component:function(){return Promise.all([r.e(0),r.e(3)]).then(r.bind(null,"ox3b"))},meta:{title:"注册"}},{path:"reset",name:"reset",component:function(){return Promise.all([r.e(0),r.e(5)]).then(r.bind(null,"3g+/"))},meta:{title:"重置密码"}}]},{path:"/index",name:"index",component:function(){return r.e(1).then(r.bind(null,"CKu4"))},meta:{title:"todos-更好的管理你的代办事项"}},{path:"/",redirect:"/index"},{path:"*",redirect:"/index"}]});h.beforeEach(function(e,t,r){switch(!0){case/^\/index/.test(e.path):r(Object(s.h)()?void 0:{name:"signin"});break;case/^\/account/.test(e.path):r(Object(s.h)()?{name:"index"}:void 0);break;default:r()}window.document.title=e.meta.title,r()});var l=h;n.default.use(c.a),n.default.use({install:function(e,t){var r=new e(t);e.prototype.$bus=r}}),n.default.config.productionTip=!1,Object(s.j)().then(function(){new n.default({el:"#app",router:l,components:{App:d},template:"<App/>"})})},oYr4:function(e,t){},uMhA:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.f99c88ae00dde18f6dfe.js.map